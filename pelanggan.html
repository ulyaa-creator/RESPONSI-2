<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LIVERA | Sistem Informasi Manajemen</title>
<style>
:root{
  --primary:#c07a3a;
  --bg:#faf7f3;
  --card:#ffffff;
  --muted:#777;
  --line:#ece6dd;
  --shadow: 0 18px 40px rgba(15, 12, 8, .08);
  --radius: 22px;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color:#1f1f1f;
}

a{color:inherit;text-decoration:none}

/* ====== LAYOUT WRAP ====== */
.wrap{max-width:1200px;margin:0 auto;padding:0 18px}

/* ====== NAVBAR ====== */
.topbar{
  position:sticky;top:0;z-index:50;
  background:#fff;
  border-bottom:1px solid var(--line);
}
.navbar{
  display:grid;
  grid-template-columns: 240px 1fr 240px;
  align-items:center;
  gap:16px;
  padding:14px 0;
}
.brand{
  display:flex;align-items:center;gap:12px;
  font-weight:800;color:var(--primary);letter-spacing:.3px;
}
.logo-img{
  width: 100px;
  height: 70px;
  object-fit:contain;
}
.searchbar{
  display:flex;justify-content:center;
}
.searchbox{
  width:min(720px, 100%);
  display:flex;align-items:center;gap:10px;
  border:1px solid var(--line);
  border-radius:999px;
  padding:8px;
  background:#fff;
}
.searchbox input{
  flex:1;border:none;outline:none;
  padding:10px 14px;
  font-size:14px;
}
.searchbox button{
  border:none;cursor:pointer;
  background:var(--primary);
  color:#fff;
  padding:10px 18px;
  border-radius:999px;
  font-weight:700;
}
.icons{
  display:flex;justify-content:flex-end;gap:10px;align-items:center;
}
.iconbtn{
  position:relative;
  border:1px solid var(--line);
  background:#fff;
  border-radius:16px;
  padding:10px 12px;
  cursor:pointer;
  display:flex;align-items:center;gap:8px;
}
.iconbtn .badge{
  position:absolute;top:-7px;right:-7px;
  background:var(--primary);color:#fff;
  font-size:12px;font-weight:800;
  width:22px;height:22px;border-radius:50%;
  display:grid;place-items:center;
}

/* ====== CATEGORY PILLS ====== */
.pills{
  display:flex;gap:10px;flex-wrap:wrap;
  padding:12px 0;
}
.pill{
  border:1px solid var(--line);
  background:#fff;
  padding:9px 14px;
  border-radius:999px;
  cursor:pointer;
  font-size:14px;
}
.pill.active{
  background:#f3e6d8;
  color:var(--primary);
  border-color:#efd7c2;
  font-weight:800;
}

/* ====== HERO SLIDER ====== */
.hero{
  margin:16px auto 18px;
  border-radius: 48px;
  overflow:hidden;
  box-shadow: var(--shadow);
  position:relative;
}

.heroSlide{
  display:none;
  position:relative;
}
.heroSlide img{
  width:100%;
  height:300px;
  object-fit:cover;
  display:block;
}

.heroOverlay{
  position:absolute;inset:0;
  background:linear-gradient(90deg, rgba(0,0,0,.55), rgba(0,0,0,0));
  display:flex;
  align-items:flex-end;
  padding:18px 26px;
}

.heroOverlay .box{
  color:#fff;
  max-width:520px;
}
.heroOverlay h1{
  margin:0 0 8px;
  font-size:42px;
  line-height:1.05;
}
.heroOverlay p{margin:0;color:#f2f2f2;line-height:1.5}
.heroDots{
  position:absolute;right:18px;bottom:18px;
  display:flex;gap:8px;
}
.dot{
  width:10px;height:10px;border-radius:50%;
  border:1px solid rgba(255,255,255,.65);
  background:transparent;
}
.dot.active{background:#fff}

/* ====== PRODUCT GRID ====== */
.sectionTitle{
  display:flex;align-items:end;justify-content:space-between;
  margin:18px 0 14px;
}
.sectionTitle h2{margin:0;font-size:26px}
.sectionTitle .meta{color:var(--muted);font-size:14px}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(240px, 1fr));
  gap:28px;
  padding-bottom:32px;
}

.card{
  background:var(--card);
  border-radius: var(--radius);
  overflow:hidden;
  box-shadow: 0 12px 26px rgba(0,0,0,.06);
  transition: transform .18s ease, box-shadow .18s ease;
}
.card:hover{transform: translateY(-4px); box-shadow: 0 18px 40px rgba(0,0,0,.10)}
.card img{
  width:100%;
  height:150px;
  object-fit:cover;
  display:block;
}
.card .info{
  padding:16px 16px 18px;
}

.name{
  font-weight:700;
  font-size:14px;
  margin:2px 0 4px;
}
.price{
  font-weight:800;
  font-size:14px;
}
.row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:6px;
  margin-bottom:12px;
}

.rating{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:13px;
}
.star{
  width:18px;height:18px;border-radius:5px;
  background: #f5d47a;
  display:inline-grid;place-items:center;
  font-size:12px;
}
.actions{
  display:flex;
  gap:12px;
  margin-top:14px;
  margin-bottom:10px;
}

.btn{
  flex:1;
  border:none;
  cursor:pointer;
  padding:8px 10px;
  border-radius:999px;
  font-weight:700;
  font-size:13px;
}
.card .btn.gray{
  margin-top:6px;
}
.card{
  display:flex;
  flex-direction:column;
}

.card .info{
  display:flex;
  flex-direction:column;
  height:100%;
}

.actions{
  margin-top:auto;
}

.btn.gray{background:#efefef}
.btn.primary{background:var(--primary);color:#fff}

/* ====== OVERLAY + DRAWERS ====== */
.overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.35);
  display:none;
  z-index:80;
}
.overlay.show{display:block}

.drawer{
  position:fixed;top:0;right:-420px;
  width:min(420px, 92vw);
  height:100%;
  background:#fff;
  z-index:90;
  box-shadow: -12px 0 40px rgba(0,0,0,.18);
  transition:right .22s ease;
  display:flex;flex-direction:column;
}
.drawer.active{right:0}

.drawerHeader{
  display:flex;align-items:center;justify-content:space-between;
  padding:18px 18px 14px;
  border-bottom:1px solid var(--line);
}
.drawerHeader h3{margin:0;font-size:20px}
.xbtn{
  width:38px;height:38px;border-radius:14px;
  border:1px solid var(--line);
  background:#fff;cursor:pointer;
}

.drawerBody{
  padding:16px 18px;
  overflow:auto;
  flex:1;
}
.drawerFooter{
  border-top:1px solid var(--line);
  padding:14px 18px;
  background:#fff;
}
.cartEmpty{
  color:var(--muted);
  margin-top:10px;
  font-size:16px;
}
.totalRow{
  display:flex;justify-content:space-between;align-items:center;
  font-weight:900;font-size:18px;
  margin-bottom:12px;
}
.footerBtns{display:flex;gap:12px}
.footerBtns a, .footerBtns button{
  flex:1;display:inline-block;text-align:center;
}
.footerBtns .btn{
  width:100%;
}

.cartItem{
  display:grid;
  grid-template-columns: 64px 1fr auto;
  gap:12px;
  padding:12px 0;
  border-bottom:1px solid #f2eee8;
}
.cartItem img{
  width:64px;height:64px;border-radius:16px;object-fit:cover;
}
.cartItem .title{font-weight:900;margin:0 0 4px}
.cartItem .sub{color:var(--muted);font-size:13px}
.qty{
  display:flex;align-items:center;gap:8px;
}
.qbtn{
  width:32px;height:32px;border-radius:12px;
  border:1px solid var(--line);background:#fff;cursor:pointer;
  display:grid;place-items:center;font-weight:900;
}
.remove{
  border:none;background:transparent;cursor:pointer;
  color:#b3572c;font-weight:900;
}

/* ====== ME PANEL CARDS ====== */
.meCard{
  background:#f5f5f5;
  border-radius:18px;
  padding:16px;
  margin-bottom:16px;
}
.meCard h4{margin:0 0 8px}
.meCard p{margin:4px 0;color:#555}
.meActions{display:flex;gap:12px;margin-top:18px}
.meActions .btn{padding:12px}

/* ====== SETTINGS TABS ====== */
.tabs{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 6px}
.tab{
  padding:10px 14px;border-radius:999px;
  border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:800;
}
.tab.active{background:#f3e6d8;color:var(--primary);border-color:#efd7c2}
.note{color:var(--muted);font-size:14px;line-height:1.5}

/* ====== TOAST ====== */
.toast{
  position:fixed;left:50%;top:16px;transform:translateX(-50%);
  background:#111;color:#fff;
  padding:10px 14px;border-radius:999px;
  font-weight:800;font-size:14px;
  display:none;
  z-index:100;
}

/* ====== FOOTER ====== */
footer{
  margin-top:20px;
  background:#111;color:#fff;
}
.footerGrid{
  display:grid;grid-template-columns:1fr 1fr;
  gap:20px;
  padding:34px 0;
}
.footerGrid b{font-size:18px}
.footerGrid p{margin:8px 0;color:#d7d7d7}

/* ====== RESPONSIVE ====== */
@media (max-width: 860px){
  .navbar{grid-template-columns: 200px 1fr 1fr}
  .icons{gap:8px}
  .heroOverlay h1{font-size:34px}
}
@media (max-width: 640px){
  .navbar{grid-template-columns: 1fr}
  .brand{justify-content:space-between}
  .searchbar{justify-content:flex-start}
  .icons{justify-content:flex-start}
  .hero img{height:320px}
  .footerGrid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div id="toast" class="toast"></div>

<!-- TOPBAR -->
<div class="topbar">
  <div class="wrap">
    <div class="navbar">
      <div class="brand">
        <img src="logo_LIVERA.png" alt="Logo LIVERA" class="logo-img">
        <span class="logo-dot"></span>
      </div>

      <div class="searchbar">
        <div class="searchbox">
          <input id="q" placeholder="Cari produk perabot..." autocomplete="off" />
          <button id="btnSearch" type="button">Search</button>
        </div>
      </div>

      <div class="icons">
        <div class="iconbtn" id="btnCart" role="button" aria-label="Keranjang">
          üõí
          <span class="badge" id="cartBadge" style="display:none">0</span>
        </div>
        <div class="iconbtn" id="btnMe" role="button" aria-label="Saya">üë§</div>
        <div class="iconbtn" id="btnSet" role="button" aria-label="Pengaturan">‚öôÔ∏è</div>
      </div>
    </div>

    <div class="pills" id="pills"></div>
  </div>
</div>

<!-- HERO SLIDER -->
<div class="wrap">
  <div class="hero" id="hero">
    <div class="heroSlide">
      <img src="https://media.istockphoto.com/id/502857637/id/foto/ruang-tamu-yang-cerah-dengan-nada-gading-ringan.jpg?s=612x612&w=0&k=20&c=xluDnnFH2OFj5DKchY07HUlUsZTCutFmIQdIwBZwD8g=" alt="Promo 1"/>
      <div class="heroOverlay"><div class="box">
        <h1>Home Living<br/>Nyaman untuk Keluarga</h1>
        <p>Produk terlaris & promo mingguan. Pilih per kategori, tambah ke keranjang, dan simulasi checkout.</p>
      </div></div>
    </div>
    <div class="heroSlide">
      <img src="https://images.unsplash.com/photo-1524758631624-e2822e304c36?auto=format&fit=crop&w=1200&q=70" alt="Promo 2"/>
      <div class="heroOverlay"><div class="box">
        <h1>Promo Sofa<br/>Ruang Keluarga</h1>
        <p>Diskon spesial untuk koleksi sofa pilihan. Klik beli sekarang atau tambah ke keranjang.</p>
      </div></div>
    </div>
    <div class="heroSlide">
      <img src="https://images.unsplash.com/photo-1505691938895-1758d7feb511?auto=format&fit=crop&w=1200&q=70" alt="Promo 3"/>
      <div class="heroOverlay"><div class="box">
        <h1>Karpet Favorit<br/>Biar Makin Cozy</h1>
        <p>Cari ‚Äúkarpet‚Äù di kolom search untuk melihat produk terkait.</p>
      </div></div>
    </div>
    <div class="heroDots" id="heroDots"></div>
  </div>

  <!-- PRODUCTS -->
  <div class="sectionTitle">
    <h2 id="title">Produk</h2>
  </div>

  <div class="grid" id="grid"></div>

  <div id="emptyState" style="display:none;color:var(--muted);padding:16px 0 26px;">
    Produk tidak ditemukan. Coba ganti kategori atau kata kunci.
  </div>
</div>

<!-- OVERLAY -->
<div id="overlay" class="overlay"></div>

<!-- DRAWER: CART -->
<div id="drawerCart" class="drawer" aria-hidden="true">
  <div class="drawerHeader">
    <h3>Keranjang Belanja</h3>
    <button class="xbtn" data-close="cart" aria-label="Close">‚úï</button>
  </div>

  <div class="drawerBody" id="cartBody"></div>

  <div class="drawerFooter">
    <div class="totalRow">
      <div>Total</div>
      <div id="cartTotalText">Rp 0</div>
    </div>
    <div class="footerBtns">
      <a class="btn gray" href="#" id="btnClearCart">Clear</a>
      <a class="btn primary" href="#" id="btnCheckout">Checkout</a>
    </div>
  </div>
</div>

<!-- DRAWER: ME -->
<div id="drawerMe" class="drawer" aria-hidden="true">
  <div class="drawerHeader">
    <h3>Bagian Saya</h3>
    <button class="xbtn" data-close="me">‚úï</button>
  </div>

  <div class="drawerBody">
    <div class="meCard">
      <h4>Informasi Akun</h4>
      <p>Nama: <b id="meName">Pelanggan</b></p>
      <p>Email: <b id="meEmail">pelanggan@email.com</b></p>
      <p>Status: <b id="meMember">REGULER</b></p>
    </div>

    <div class="meCard">
      <h4>Lihat Pengiriman</h4>
      <p>Order: <b id="lastOrder">-</b></p>
      <p>Status: <b id="lastStatus">-</b></p>
      <p>Estimasi: <b id="lastEta">-</b></p>
    </div>

    <div class="meActions">
      <div style="width:100%">
        <input type="text" id="editNama"
               value="Pelanggan"
               style="width:100%;padding:10px;border-radius:12px;border:1px solid #ddd;margin-bottom:10px">

        <input type="email" id="editEmail"
               value="pelanggan@email.com"
               style="width:100%;padding:10px;border-radius:12px;border:1px solid #ddd;margin-bottom:12px">

        <button class="btn gray" id="btnSaveProfile">Simpan Profil</button>
      </div>

      <button class="btn primary btnBuy"
  data-id="1"
  data-name="Meja Belajar Anak"
  data-price="7950000"
  data-img="img/meja.jpg">
  Beli
</button>

    </div>
  </div>
</div>

<!-- DRAWER: SETTINGS -->
<div id="drawerSet" class="drawer" aria-hidden="true">
  <div class="drawerHeader">
    <h3>Pengaturan</h3>
    <button class="xbtn" data-close="set" aria-label="Close">‚úï</button>
  </div>

  <div class="drawerBody">
    <div class="meCard">
      <h4>Preferensi</h4>
      <div class="note">Ini contoh panel pengaturan untuk SIM.</div>
      <div class="tabs" id="tabs">
        <button class="tab active" data-tab="mode" type="button">Mode Tampilan</button>
        <button class="tab" data-tab="alamat" type="button">Alamat</button>
        <button class="tab" data-tab="bayar" type="button">Pembayaran</button>
      </div>
      <div class="note" id="tabContent">
        Mode tampilan: Light (default). (Simulasi UI)
      </div>
      <div style="margin-top:16px">
        <a class="btn primary" href="#" id="btnLogoutSim">Logout</a>
      </div>
    </div>
  </div>
</div>

<!-- DRAWER: DETAIL PRODUK / ULASAN -->
<div id="drawerReview" class="drawer">
  <div class="drawerHeader">
    <h3 id="reviewTitle">Ulasan Produk</h3>
    <button class="xbtn" onclick="closeAll()">‚úï</button>
  </div>
  <div class="drawerBody" id="reviewBody"></div>
</div>

<!-- FOOTER -->
<footer>
  <div class="wrap">
    <div class="footerGrid">
      <div>
        <b>Contact & Address</b>
        <p>LIVERA Home Living</p>
        <p>Jl. Contoh No. 123, Yogyakarta</p>
        <p>CS: 08xx-xxxx-xxxx</p>
      </div>
      <div>
        <b>Social</b>
        <p>Instagram ¬∑ TikTok ¬∑ Twitter</p>
        <p>Promo mingguan & koleksi terbaru</p>
      </div>
    </div>
  </div>
</footer>

<script>
/* ========================= DATA (DARI PHP ‚Üí JS) ========================= */
const categories = {
  'All':'Semua',
  'Sofas':'Sofa',
  'Tables':'Meja',
  'Chairs':'Kursi',
  'Bedroom':'Bedroom',
  'Lemari':'Lemari',
  'Kids':'Anak',
  'Decor':'Decor',
  'Carpet':'Karpet'
};

const products = [
  /* SOFA */
  {id:1,name:'Sofa Aurora',category:'Sofas',price:2800000,rating:4.8,img:'https://media.istockphoto.com/id/1183908655/id/foto/interior-ruang-tamu-modern-dengan-sofa-nyaman.jpg?s=612x612&w=0&k=20&c=M2b1g7CfuQAb18obCzIcjaF39wiFKRB8qcqviMyQXoA='},
  {id:2,name:'Sofa Harmoni',category:'Sofas',price:3500000,rating:4.9,img:'https://media.istockphoto.com/id/943910360/id/foto/poster-di-interior-apartemen-yang-nyaman.jpg?s=612x612&w=0&k=20&c=Roy7Woe65wgCs22VTN-wxZ7Cu3WGX_mMC04bnhdzk4c='},
  {id:3,name:'Sofa Elora',category:'Sofas',price:2600000,rating:4.6,img:'https://plus.unsplash.com/premium_photo-1683141389818-77fd3485334b?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTd8fHNvZmF8ZW58MHx8MHx8fDA%3D'},
  {id:4,name:'Sofa Nara',category:'Sofas',price:2400000,rating:4.5,img:'https://media.istockphoto.com/id/2175713697/id/foto/ruang-tamu-cerah-dengan-perapian-dan-desain-skandinavia.jpg?s=612x612&w=0&k=20&c=skLBfyo6R2NZEBaTM4VT0iLnUHMdibodieWt0RGp6sU='},
  {id:5,name:'Sofa Casa',category:'Sofas',price:3200000,rating:4.7,img:'https://media.istockphoto.com/id/1184204517/id/foto/interior-ruang-tamu-skandinavia-modern-render-3d.jpg?s=612x612&w=0&k=20&c=rRkh5sVNmWQVW9Tj40v0yWQ1P-kDanjdB7lBBJwGX0U='},
  {id:6,name:'Sofa Liora',category:'Sofas',price:2900000,rating:4.6,img:'https://media.istockphoto.com/id/2198530469/id/foto/desain-interior-modern-sofa-di-ruang-tamu.jpg?s=612x612&w=0&k=20&c=7bTIRpbo9NMMShERFRlym7XYZROgz33MeO3kaBrodvU='},
  {id:7,name:'Sofa Santara',category:'Sofas',price:3700000,rating:4.9,img:'https://media.istockphoto.com/id/1031444360/id/foto/poster-di-atas-lemari-putih-dengan-tanaman-di-sebelah-sofa-abu-abu-di-interior-ruang-tamu.jpg?s=612x612&w=0&k=20&c=snvvhDDAcaYgbpFrCyvyTGmUjeAPyYC0QVpIY0o9RKw='},
  {id:8,name:'Sofa Cozyra',category:'Sofas',price:3000000,rating:4.7,img:'https://media.istockphoto.com/id/927080588/id/foto/sofa-kain-biru-pada-latar-belakang-putih-gambar-rendering-3d.jpg?s=612x612&w=0&k=20&c=pjnwtsC4QexHf3gCqRTrnVHfawSz2zyce2bMkRC2qCo='},
  {id:9,name:'Sofa Arka',category:'Sofas',price:2700000,rating:4.5,img:'https://media.istockphoto.com/id/637876746/id/foto/ruang-tamu-modern-dengan-sofa-oranye.jpg?s=612x612&w=0&k=20&c=3aq9ifhOGxCdKqNYNO9YiVwgmWi6bMtvQGB3ifRR7wg='},
  {id:10,name:'Sofa Livin',category:'Sofas',price:3400000,rating:4.8,img:'https://media.istockphoto.com/id/2207308018/id/foto/interior-ruang-tamu-modern-dengan-sofa-lampu-lantai-tanaman-pot-meja-kopi-dan-dinding-kosong.jpg?s=612x612&w=0&k=20&c=FOSFxds-kEhXbgefeC5xKVb7uYqz5ha8TRiFM4bBApc='},

  /* TABLES */
  {id:101,name:'Meja Makan Keluarga',category:'Tables',price:1800000,rating:4.7,img:'https://media.istockphoto.com/id/1302808961/id/foto/ruang-rapat-yang-nyaman-partisi-privasi-ada-di-atas-meja.jpg?s=612x612&w=0&k=20&c=zYGMyQrtQz4eAtCAxSVESrN4twlXRdKOyZEe63wO0Es='},
  {id:102,name:'Meja Kayana',category:'Tables',price:2200000,rating:4.8,img:'https://media.istockphoto.com/id/1388783758/id/foto/interior-restoran-dengan-meja-kayu-modern-dan-dua-kursi-dengan-tanaman-yang-didekorasi-oleh.jpg?s=1024x1024&w=is&k=20&c=hgYjDVEw0vN2KO6oW94BIKnbZ6m200TMCLAC6o4GotU='},
  {id:103,name:'Meja Nuvia',category:'Tables',price:1650000,rating:4.6,img:'https://media.istockphoto.com/id/2185332802/id/foto/meja-dan-kursi-kafe-di-dekat-jendela-dengan-taman-hijau-luar-ruangan.jpg?s=612x612&w=0&k=20&c=ij6fhvn9cOX2YinuRLqrWeUtuXOqmbm9FS7pBgk0ijU='},
  {id:104,name:'Meja Laras',category:'Tables',price:2400000,rating:4.9,img:'https://media.istockphoto.com/id/1177844431/id/foto/interior-kantor-rumah-modern-gaya-skandinavia.jpg?s=612x612&w=0&k=20&c=vqjZRPQWfEseo3AbHagwm998jH_UE1o-OMUCV12dCDA='},
  {id:105,name:'Meja Darsya',category:'Tables',price:1950000,rating:4.7,img:'https://media.istockphoto.com/id/2177550121/id/foto/wanita-di-meja-modern-fokus-bekerja-di-ruang-kantor-minimalis-yang-cerah.jpg?s=612x612&w=0&k=20&c=aEkhTLcz8UKSsScXcNREViEM1EK6FFWePej_BG_AV4E='},
  {id:106,name:'Meja Elvora',category:'Tables',price:2600000,rating:4.8,img:'https://media.istockphoto.com/id/1469883713/id/foto/interior-kantor-ceo-kosong-dengan-meja-kursi-kantor-lemari-dan-dinding-bata.jpg?s=612x612&w=0&k=20&c=fLKxzezAWnjJnzTY-_rnjgI32ztQOxmmpnXCn8C3mZQ='},
  {id:107,name:'Meja Senja',category:'Tables',price:2100000,rating:4.6,img:'https://media.istockphoto.com/id/2247455061/id/foto/interior-kantor-rumah-sederhana-minimalis-dengan-meja-kursi-tanaman-pot-yang-ditempatkan-di.jpg?s=612x612&w=0&k=20&c=d6-kt14B0du85UrRzYYLHfA_bHm75cn8vMDHgOfMqzI='},
  {id:108,name:'Meja Altara',category:'Tables',price:2800000,rating:4.9,img:'https://media.istockphoto.com/id/1271533361/id/foto/interior-rumah-skandinavia-ruang-tamu-dengan-komoditas-kayu-desain-tanaman-tropis-lampu.jpg?s=612x612&w=0&k=20&c=PI1vvs5mppY1WaZT5BH4hLdC5ZU0yvWduIgx0rK6BIY='},
  {id:109,name:'Meja Kalyra',category:'Tables',price:2300000,rating:4.7,img:'https://media.istockphoto.com/id/1264751681/id/foto/meja-makan-kayu-di-kedai-kopi.jpg?s=612x612&w=0&k=20&c=Ui428ygpnj41U8zbNWO8kCForQHTVsRhnfHq82-VBtA='},

  /* CHAIRS */
  {id:201,name:'Kursi Nara',category:'Chairs',price:850000,rating:4.6,img:'https://media.istockphoto.com/id/1201758007/id/foto/eksterior-dinding-kosong-dengan-kayu-putih-plank-3d-render.jpg?s=612x612&w=0&k=20&c=2hHdqGPvRUec-xkkfs6LURkee7ICE79a3qIhWBBruak='},
  {id:202,name:'Kursi Eluna',category:'Chairs',price:920000,rating:4.7,img:'https://media.istockphoto.com/id/2219140165/id/foto/percakapan-yang-menginspirasi-terungkap-di-studio-podcast-modern-dengan-pengaturan-yang-nyaman.jpg?s=612x612&w=0&k=20&c=8H2FNALREiB6hDV7Xu3jxUSniqnDuznxk4fLvF1ACjQ='},
  {id:203,name:'Kursi Kayu Artha',category:'Chairs',price:780000,rating:4.5,img:'https://media.istockphoto.com/id/2167232035/id/foto/kursi-dengan-bingkai-hitam-dan-kayu-serta-bantal-abu-abu.jpg?s=612x612&w=0&k=20&c=uPjJSQA6z8tYmBfQqqIPJhlxiIf49FD-mwhwrL1XIzo='},
  {id:204,name:'Kursi Senara',category:'Chairs',price:990000,rating:4.8,img:'https://media.istockphoto.com/id/1321320083/id/foto/rendering-3d-dari-kursi-kayu-kursi-kayu-rotan-wicker-modern-yang-terisolasi.jpg?s=612x612&w=0&k=20&c=f0UH9r9DAgky7Rx0QY0L6swZIftWPmycaf677mxZeHo='},
  {id:205,name:'Kursi Livia',category:'Chairs',price:870000,rating:4.6,img:'https://media.istockphoto.com/id/1172339995/id/foto/dua-kursi-di-balkon-yang-nyaman.jpg?s=612x612&w=0&k=20&c=SdeyOtz1mSqFIFRnsn-k7madxZhl_WjvHJZvUP-8LGc='},
  {id:206,name:'Kursi Palma',category:'Chairs',price:910000,rating:4.7,img:'https://media.istockphoto.com/id/1336880908/id/foto/teras-rumah-dengan-tanaman-dinding-kayu-dan-meja-sofa-yang-nyaman-kursi-berlengan-dan-lentera.jpg?s=612x612&w=0&k=20&c=REieEMz-14gKMgW4kl1sVlsPtE9of4io9oOxUPBsVFw='},
  {id:207,name:'Kursi Santai Lumo',category:'Chairs',price:1150000,rating:4.8,img:'https://media.istockphoto.com/id/1401586488/id/foto/kursi-taman-lounge-di-halaman-belakang.jpg?s=612x612&w=0&k=20&c=HmDnqD30-WKILWuoj8MrN4BNM47jqxFNd9tWR7D3kZI='},
  {id:208,name:'Kursi Aruni',category:'Chairs',price:830000,rating:4.5,img:'https://media.istockphoto.com/id/1006496062/id/foto/foto-nyata-kursi-taman-modern-dengan-bantal-putih-bergaris-berdiri-di-dek-kayu-di-taman-retret.jpg?s=612x612&w=0&k=20&c=hz5wL2VfCyTs4t0z9rhHUqYD25hguNPUJvOL6T2QVZ8='},

  /* BEDROOM */
  {id:301,name:'Tempat Tidur Aurora',category:'Bedroom',price:4500000,rating:4.9,img:'https://images.unsplash.com/photo-1615874959474-d609969a20ed?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YmVkcm9vbXxlbnwwfHwwfHx8MA%3D%3D'},
  {id:302,name:'Tempat Tidur Elvara',category:'Bedroom',price:4800000,rating:4.8,img:'https://images.unsplash.com/photo-1598928636135-d146006ff4be?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fGJlZHJvb218ZW58MHx8MHx8fDA%3D'},
  {id:303,name:'Tempat Tidur Nuvia',category:'Bedroom',price:4200000,rating:4.7,img:'https://images.unsplash.com/photo-1562438668-bcf0ca6578f0?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fGJlZHJvb218ZW58MHx8MHx8fDA%3D'},
  {id:304,name:'Tempat Tidur Arka',category:'Bedroom',price:4600000,rating:4.8,img:'https://media.istockphoto.com/id/2194122031/photo/cozy-modern-bedroom-design.webp?a=1&b=1&s=612x612&w=0&k=20&c=VeQRJvHDEdafzwhlC-V-D_wcHuAEiDbWS_fOfTgYC4I='},
  {id:305,name:'Tempat Tidur Savina',category:'Bedroom',price:4900000,rating:4.9,img:'https://media.istockphoto.com/id/1472439241/photo/modern-bedroom-interior-with-double-bed-armchair-and-night-tables.webp?a=1&b=1&s=612x612&w=0&k=20&c=62ROX3YuTD4SF1oi8R_N1TIb1SRCGI8yF-mgulfdKxI='},
  {id:306,name:'Tempat Tidur Liora',category:'Bedroom',price:4300000,rating:4.6,img:'https://media.istockphoto.com/id/2045383950/id/foto/render-digital-dari-oasis-kamar-tidur-yang-tenang-dengan-cahaya-alami.jpg?s=612x612&w=0&k=20&c=wnvf1KGJBPh9FBHj6TzZRE3XQbio2waK4cII401s2EA='},
  {id:307,name:'Tempat Tidur Calmia',category:'Bedroom',price:4700000,rating:4.8,img:'https://media.istockphoto.com/id/1266155634/id/foto/interior-kamar-tidur-yang-mewah-dan-elegan.jpg?s=612x612&w=0&k=20&c=DajjzjsXTXo3WHqdxB_wghnYJUQPhHgkfPg1IC5oPRE='},
  {id:308,name:'Tempat Tidur Darsya',category:'Bedroom',price:4400000,rating:4.7,img:'https://media.istockphoto.com/id/2150226299/id/foto/kamar-tidur-mewah-dengan-langit-langit-ke-lantai-tirai-krem-tempat-tidur-meja-samping-tempat.jpg?s=612x612&w=0&k=20&c=ssB0UAza0tb31WWmthTzIFzzzR3XuOAeNwDW59a5O_8='},
  {id:309,name:'Tempat Tidur Senja',category:'Bedroom',price:5000000,rating:4.9,img:'https://media.istockphoto.com/id/1494615301/id/foto/mockup-rumah-latar-belakang-interior-kamar-tidur-dengan-furnitur-rotan-dan-dinding-kosong-gaya.jpg?s=612x612&w=0&k=20&c=5_b8fMb3u-XdQ-hc_DtRjUqRWIHOvch-OQn3kFNLcAA='},
  {id:310,name:'Tempat Tidur Velora',category:'Bedroom',price:5200000,rating:5.0,img:'https://media.istockphoto.com/id/1222723728/id/foto/rendering-3d-dari-kamar-tidur-pergantian-tradisional-abad-ini.jpg?s=612x612&w=0&k=20&c=346F8ARxk-4AZGc2CACT_dRKlhWlui4BpuXJhox46JU='},

  /* CARPET */
  {id:401,name:'Karpet Arumi',category:'Carpet',price:650000,rating:4.6,img:'https://media.istockphoto.com/id/1185644741/photo/yellow-brown-carpet-made-of-sheepskin-wool-on-an-isolated-background-3d-rendering.webp?a=1&b=1&s=612x612&w=0&k=20&c=NEDIMQkVvM7gCfYYit9vnMrdyHDR7HqZKaiwq9wMHJA='},
  {id:402,name:'Karpet Senada',category:'Carpet',price:720000,rating:4.7,img:'https://media.istockphoto.com/id/1320633607/photo/gray-round-fluffy-carpet-3d-illustration.webp?a=1&b=1&s=612x612&w=0&k=20&c=n20i0YFCcY1Zwm9ehtYgFJuVCRq4fU4zNfgRB7wlgyE='},
  {id:403,name:'Karpet Lova',category:'Carpet',price:580000,rating:4.5,img:'https://media.istockphoto.com/id/2167971333/id/foto/interior-apartemen-modern.jpg?s=612x612&w=0&k=20&c=SWMG0yV1d99bAZUbFWe8XfV59gzDezyqsiNKxgoXrEs='},
  {id:404,name:'Karpet Calira',category:'Carpet',price:790000,rating:4.8,img:'https://media.istockphoto.com/id/2216511339/id/foto/ruang-tamu-modern-yang-nyaman-dengan-sofa-melengkung-dan-cahaya-alam-yang-hangat.jpg?s=612x612&w=0&k=20&c=dgxHuUfQJxpYe8THokmELCNgNrSumhpIjLBVDvPcup4='},
  {id:405,name:'Karpet Naya',category:'Carpet',price:620000,rating:4.6,img:'https://media.istockphoto.com/id/2229007771/id/foto/koridor-bangunan-panjang-mengkilap-kosong.jpg?s=612x612&w=0&k=20&c=N0BTz8fHf7saPy3C0E-hELpdU-hCMPoziejCaHgKAio='},
  {id:406,name:'Karpet Elvi',category:'Carpet',price:700000,rating:4.7,img:'https://media.istockphoto.com/id/2196705168/id/foto/ruang-tamu-minimalis-modern-dengan-sofa-sectional-dan-meja-kopi-marmer.jpg?s=612x612&w=0&k=20&c=s52Ydj-9ChvOKm7IAxN2L8TWK5b_fGawQv9nXd6K5SM='},
  {id:407,name:'Karpet Zafra',category:'Carpet',price:840000,rating:4.9,img:'https://media.istockphoto.com/id/907670734/id/foto/karpet-di-parket.jpg?s=612x612&w=0&k=20&c=F1uTXS3a8wtnC_ndl_Bf-IX4xssC7vg1HhSTub_9tn4='},
  {id:408,name:'Karpet Lunea',category:'Carpet',price:760000,rating:4.8,img:'https://media.istockphoto.com/id/2213325079/id/foto/karpet-lembut-bergaya-dengan-pola-di-lantai-di-ruang-tamu.jpg?s=612x612&w=0&k=20&c=g_AsBpuYhJG5hxEbwOCWLRnX_cAawXRIkGCWVPIStZc='},
  {id:409,name:'Karpet Sora',category:'Carpet',price:690000,rating:4.6,img:'https://media.istockphoto.com/id/2156883918/id/foto/permadani-bundar-putih-di-ruang-tamu.jpg?s=612x612&w=0&k=20&c=WJkQl_AhavFyq919FWMdf8HMNbSFxUHiThGaRVoriAY='},
  {id:410,name:'Karpet Arka',category:'Carpet',price:880000,rating:4.9,img:'https://media.istockphoto.com/id/513729219/id/foto/ruang-tamu-yang-cantik-dengan-perapian-dan-dek-walkout.jpg?s=612x612&w=0&k=20&c=4ZFmRGd0m1BBI6AITT3AwSQwqrjVeSe6HoQeE9rIF4A='},

  /* KIDS */
  {id:501,name:'Lemari Mainan Anak',category:'Kids',price:2800000,rating:4.8,img:'https://media.istockphoto.com/id/1364556745/id/foto/lemari-dengan-mainan-di-pusat-hiburan-anak-anak-mainan-untuk-anak-anak-di-rak.jpg?s=612x612&w=0&k=20&c=vhXfK9SaInrJlXJIwsu_gKBhNfXxODHvRooHVkZnWH8='},
  {id:502,name:'Perosotan Anak',category:'Kids',price:950000,rating:4.6,img:'https://media.istockphoto.com/id/2176431267/id/foto/ruang-bermain-anak-kosong.jpg?s=612x612&w=0&k=20&c=G3k5_nUh2i5P7bGJa5aJrx5np0QKr_JJXhuu1l1bTuU='},
  {id:503,name:'Meja Belajar Anak',category:'Kids',price:650000,rating:4.5,img:'https://images.unsplash.com/photo-1602541975165-6ae912c931b7?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OHx8bWVqYSUyMGJlbGFqYXIlMjBhbmFrfGVufDB8fDB8fHww'},
  {id:504,name:'Mainan Anak',category:'Kids',price:1750000,rating:4.7,img:'https://plus.unsplash.com/premium_photo-1703389457707-f1c53e6eff31?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDN8fHxlbnwwfHx8fHw%3D'},
  {id:505,name:'Mainan Anak',category:'Kids',price:820000,rating:4.6,img:'https://plus.unsplash.com/premium_photo-1723575696500-471244e10dd9?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDMzfHx8ZW58MHx8fHx8'},
  {id:506,name:'Meja Gambar Anak',category:'Kids',price:780000,rating:4.5,img:'https://plus.unsplash.com/premium_photo-1723050178445-b20bfc320712?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OXx8bWVqYSUyMGJlbGFqYXIlMjBhbmFrfGVufDB8fDB8fHww'},
  {id:507,name:'Tempat Tidur Tingkat Anak',category:'Kids',price:720000,rating:4.6,img:'https://media.istockphoto.com/id/2239950485/photo/japandi-bedroom.webp?a=1&b=1&s=612x612&w=0&k=20&c=eiClQ6Yx84yF2LwvIvVUW7wFYy-yRRc5T9rnOGRJ4Zk='},
  {id:508,name:'Tempat Tidur Tingkat Anak',category:'Kids',price:4200000,rating:4.9,img:'https://media.istockphoto.com/id/1316249804/photo/bedroom-design-with-staircase-cabinet-and-bunk-bed.webp?a=1&b=1&s=612x612&w=0&k=20&c=qffpondvLRM6NllVO43nHnWXiUcvxJT_Itoc896idRk='},

  /* DECOR */
  {id:601,name:'Lukisan Kanvas Minimalis',category:'Decor',price:650000,rating:4.6,img:'https://media.istockphoto.com/id/1813179341/id/foto/abstrak-wallpaper-cat-modern-ilustrasi-3d-minimalis-boho-wall-poster-art-karya-seni-kanvas.jpg?s=612x612&w=0&k=20&c=EtrCPSwI1vTSyvJcGJfO67lOhAY75KDEhDQ7EArdqxQ='},
  {id:602,name:'Hiasan Dinding Estetik',category:'Decor',price:480000,rating:4.5,img:'https://media.istockphoto.com/id/948865750/id/foto/cermin-bulat-tergantung-di-dinding-yang-mencerminkan-pemandangan-desain-interior-dapur-putih.jpg?s=612x612&w=0&k=20&c=GonUdiYqIF8hluJJzOZT6ZYFsAPfTjc6Z8mvLhpTV4k='},
  {id:603,name:'Cermin Dinding Bulat',category:'Decor',price:820000,rating:4.8,img:'https://media.istockphoto.com/id/2239250117/id/foto/kamar-mandi-japandi-di-malam-hari-dengan-ubin-batu-alam-krem-dan-pencahayaan-led-ambien.jpg?s=612x612&w=0&k=20&c=1ABxPXMUIcAbci7SEicj5Rp8M_xiE3K7B5yE3Cifrik='},
  {id:604,name:'Vas Keramik',category:'Decor',price:420000,rating:4.5,img:'https://media.istockphoto.com/id/2224512667/id/foto/vas-bergaya-dan-cabang-snowberry-di-atas-meja-putih.jpg?s=612x612&w=0&k=20&c=82_bP-AFNsB5ZicTX_x3fhh939IRMkUZ8sHGN1e__1E='},
  {id:605,name:'Tanaman Hias Artificial',category:'Decor',price:390000,rating:4.4,img:'https://media.istockphoto.com/id/2154148537/id/foto/tampak-samping-tanaman-hias-pot-areca-palm.jpg?s=612x612&w=0&k=20&c=juTxQGqTb0SytTaw43QFmiHmv3_3S7wInh2fVFksEKg='},
  {id:606,name:'Lampu Meja Estetik',category:'Decor',price:780000,rating:4.7,img:'https://media.istockphoto.com/id/1394163582/photo/japanese-travel-2021-spring.webp?a=1&s=612x612&w=0&k=20&c=_YEDBRNGUaGSyM0MWkKjmHdRSJX9DSZNRNqoc93AWK4='},
  {id:607,name:'Lilin Aromaterapi',category:'Decor',price:260000,rating:4.6,img:'https://media.istockphoto.com/id/91620032/photo/still-life-with-candles.webp?a=1&b=1&s=612x612&w=0&k=20&c=icabZkCD5V0npZp92TaAiEHMOfrR_KAvMmqD9h8utN0='},
  {id:608,name:'Bantal Sofa Dekoratif',category:'Decor',price:320000,rating:4.4,img:'https://plus.unsplash.com/premium_photo-1739612422471-856ba749b780?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTd8fEJhbnRhbCUyMFNvZmElMjBEZWtvcmF0aWZ8ZW58MHx8MHx8fDA%3D'},
  {id:609,name:'Patung Dekor Abstrak',category:'Decor',price:540000,rating:4.5,img:'https://media.istockphoto.com/id/1881558175/id/foto/close-up-rumah.jpg?s=612x612&w=0&k=20&c=KW_w4GX2kp7GcjDGk-RaochMDYTvpFMwTq-Qlxyy5yw='},
  {id:610,name:'Tray Dekor Meja',category:'Decor',price:290000,rating:4.3,img:'https://media.istockphoto.com/id/1361277988/photo/the-platform-and-curtain-background-for-the-product-shoot.webp?a=1&b=1&s=612x612&w=0&k=20&c=DxiDR9_sFP7bycMHvBaA47OHsF7s_hBscTLIxIVr2fc='},

  /* LEMARI */
  {id:701,name:'Lemari Arkana',category:'Lemari',price:3800000,rating:4.8,img:'https://media.istockphoto.com/id/1141212809/id/foto/lemari-pakaian-kayu-modern-dengan-pakaian-wanita-tergantung-di-rel-dalam-berjalan-di-interior.jpg?s=612x612&w=0&k=20&c=kZMogyxmXdRuBE6FV3F-dWcc8Z5998ToODUcibT-YCQ='},
  {id:702,name:'Lemari Elvara',category:'Lemari',price:4200000,rating:4.9,img:'https://media.istockphoto.com/id/1139151279/id/foto/lemari-klasik-vintage-lama-dengan-barang-barang.jpg?s=612x612&w=0&k=20&c=ul7bRif_AZGASx2nwE7HiWfOS22HcNvtbihMY8cr22s='},
  {id:703,name:'Lemari Savira',category:'Lemari',price:3600000,rating:4.7,img:'https://media.istockphoto.com/id/1436370795/id/foto/desain-walk-in-closet-yang-modern-dan-elegan-dengan-rak-dan-pakaian-pria-yang-rapi-dapat.jpg?s=612x612&w=0&k=20&c=6u9KvcDms1X2L7b6ET4zTQrUOou1QpxO6qKweE1XBLg='},
  {id:704,name:'Lemari Nuvia',category:'Lemari',price:4000000,rating:4.8,img:'https://media.istockphoto.com/id/1453723844/id/foto/interior-ruang-ganti-dengan-sepatu-tas-dan-pakaian-gantung.jpg?s=612x612&w=0&k=20&c=uSKWoA4_pM14pc0QqSlW2_lch3PduRRQ_PIyF4mNWMI='},
  {id:705,name:'Lemari Calista',category:'Lemari',price:3900000,rating:4.7,img:'https://media.istockphoto.com/id/2238685144/id/foto/interior-ruang-ganti-modern-mewah-dengan-walk-in-closet-lemari-pakaian-elegan-dan-area-meja.jpg?s=612x612&w=0&k=20&c=S9oTI9MVf6zHAYG6S_3dHlP5IJujqKUMs95cunMH8DA='},
  {id:706,name:'Lemari Lunara',category:'Lemari',price:4300000,rating:4.9,img:'https://media.istockphoto.com/id/938987470/id/foto/3d-membuat-kayu-putih-skandinavia-modern-berjalan-di-lemari-dengan-lemari-pakaian-dekat-jendela.jpg?s=612x612&w=0&k=20&c=w4pv83zkNWQhdyaKi4zedJ69BC-JtOEtQG4kecQCVa4='},
  {id:707,name:'Lemari Darsya',category:'Lemari',price:3700000,rating:4.6,img:'https://media.istockphoto.com/id/2226434303/id/foto/tampilan-depan-lemari-pakaian-dengan-sepatu-tas-dan-pakaian-gantung-ruang-ganti-modern.jpg?s=612x612&w=0&k=20&c=9nUVFwD6Uu1clJVRMa-1yY9gFrqGkLGKvvqZdb5f2dA='},
  {id:708,name:'Lemari Velora',category:'Lemari',price:4500000,rating:5.0,img:'https://media.istockphoto.com/id/643673538/id/foto/rendering-3d-kayu-minimal-berjalan-di-lemari-dengan-lemari-pakaian.jpg?s=612x612&w=0&k=20&c=irWpQTG7fhc1KaLcZN6AtqRIre2TE3tbmYZL-iJiBbw='},
  {id:709,name:'Lemari Kayana',category:'Lemari',price:4100000,rating:4.8,img:'https://media.istockphoto.com/id/1086262842/id/foto/3d-membuat-kayu-skandinavia-mewah-berjalan-di-lemari-dengan-lemari-pakaian.jpg?s=612x612&w=0&k=20&c=NXouZnOePxPRMVziy1AOk3Cl73Hc-aUC46Kb9tgTUMU='},
  {id:710,name:'Lemari Amora',category:'Lemari',price:3950000,rating:4.7,img:'https://media.istockphoto.com/id/1215467698/id/foto/rendering-3d-kayu-skandinavia-putih-minimal-berjalan-di-lemari-dengan-lemari-pakaian.jpg?s=612x612&w=0&k=20&c=lqpsl8g8E1r0WTDp7E_6bAc-1d5XdI2Y4JYR4x8vLHk='},
];

const reviews = {
  1: [
    {user:'Ani', rating:5, comment:'Sofa empuk, warna cantik.'},
    {user:'Budi', rating:4, comment:'Sesuai foto, pengiriman cepat.'},
  ],
  2: [
    {user:'Rina', rating:5, comment:'Nyaman dan besar.'},
  ]
};

function rupiah(n){
  n = Number(n||0);
  return "Rp " + n.toLocaleString('id-ID');
}
function avgRating(productId){
  if(!reviews[productId]) return null;
  const sum = reviews[productId].reduce((a,b)=>a + Number(b.rating||0), 0);
  return Math.round((sum / reviews[productId].length) * 10) / 10;
}

/* ========================= STORAGE (SESSION ‚Üí localStorage) ========================= */
const LS_CART = 'liv_cart';
const LS_PROFILE = 'liv_profile';
const LS_LASTORDER = 'liv_last_order';

function loadCart(){
  try { return JSON.parse(localStorage.getItem(LS_CART) || '{}'); }
  catch { return {}; }
}
function saveCart(cart){
  localStorage.setItem(LS_CART, JSON.stringify(cart || {}));
}
function loadProfile(){
  try { return JSON.parse(localStorage.getItem(LS_PROFILE) || '{}'); }
  catch { return {}; }
}
function saveProfile(p){
  localStorage.setItem(LS_PROFILE, JSON.stringify(p || {}));
}
function loadLastOrder(){
  try { return JSON.parse(localStorage.getItem(LS_LASTORDER) || '{}'); }
  catch { return {}; }
}
function saveLastOrder(o){
  localStorage.setItem(LS_LASTORDER, JSON.stringify(o || {}));
}

/* ===================== TOAST ===================== */
function showToast(msg){
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.display = 'block';
  clearTimeout(window.__toastTimer);
  window.__toastTimer = setTimeout(()=>{ t.style.display='none'; }, 1800);
}

/* ===================== DRAWERS ===================== */
const overlay = document.getElementById('overlay');
const drawerCart = document.getElementById('drawerCart');
const drawerMe = document.getElementById('drawerMe');
const drawerSet = document.getElementById('drawerSet');
const drawerReview = document.getElementById('drawerReview');

function openDrawer(which){
  overlay.classList.add('show');
  if(which==='cart') drawerCart.classList.add('active');
  if(which==='me') drawerMe.classList.add('active');
  if(which==='set') drawerSet.classList.add('active');
  if(which==='review') drawerReview.classList.add('active');
}
function closeAll(){
  overlay.classList.remove('show');
  drawerCart.classList.remove('active');
  drawerMe.classList.remove('active');
  drawerSet.classList.remove('active');
  drawerReview.classList.remove('active');
}

document.getElementById('btnCart').addEventListener('click', ()=>openDrawer('cart'));
document.getElementById('btnMe').addEventListener('click', ()=>openDrawer('me'));
document.getElementById('btnSet').addEventListener('click', ()=>openDrawer('set'));
overlay.addEventListener('click', closeAll);
document.querySelectorAll('.xbtn').forEach(btn=> btn.addEventListener('click', closeAll));

/* ===================== PILLS (DARI PHP LOOP ‚Üí JS) ===================== */
const pillsWrap = document.getElementById('pills');
function renderPills(){
  pillsWrap.innerHTML = '';
  Object.keys(categories).forEach((key, idx)=>{
    const b = document.createElement('button');
    b.type='button';
    b.className = 'pill' + (key==='All' ? ' active' : '');
    b.dataset.cat = key;
    b.textContent = categories[key];
    pillsWrap.appendChild(b);
  });
}
renderPills();

/* ===================== PRODUCTS GRID (DARI PHP LOOP ‚Üí JS) ===================== */
const grid = document.getElementById('grid');
function renderProducts(){
  grid.innerHTML = '';
  products.forEach(p=>{
    const avg = avgRating(p.id) ?? p.rating;

    const card = document.createElement('div');
    card.className = 'card product';
    card.dataset.id = p.id;
    card.dataset.cat = p.category;
    card.dataset.name = (p.name||'').toLowerCase();
    card.dataset.price = p.price;
    card.dataset.rating = p.rating;
    card.dataset.img = p.img;

    card.innerHTML = `
      <img src="${escapeHtml(p.img)}" alt="${escapeHtml(p.name)}"/>
      <div class="info">
        <div class="name">${escapeHtml(p.name)}</div>
        <div class="row">
          <div class="price">${rupiah(p.price)}</div>
          <div class="rating">
            <span class="star">‚òÖ</span>
            ${avg}
          </div>
        </div>
        <div class="actions">
        
          <button
  class="btn primary"
  data-act="buy"
  data-id="${p.id}"
  data-name="${escapeHtml(p.name)}"
  data-price="${p.price}"
  data-img="${escapeHtml(p.img)}"
>
  Beli
</button>
        </div>
        <button class="btn gray" data-act="review">Lihat ¬∑ Rating & Ulasan</button>
      </div>
    `;
    grid.appendChild(card);
  });

  // binding actions
  grid.querySelectorAll('.product').forEach(card=>{
    const id = Number(card.dataset.id);
    card.querySelectorAll('button[data-act]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const act = btn.dataset.act;
        if(act==='add') addToCart(id, 1, true);
        if(act==='buy') { addToCart(id, 1, true); openDrawer('cart'); showToast('Produk masuk keranjang. Silakan checkout üëå'); }
        if(act==='review') openReview(id);
      });
    });
  });
}
renderProducts();

function escapeHtml(s){
  return String(s ?? '')
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;') 
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'","&#039;");
}

/* ===================== CART LOGIC (SESSION CART ‚Üí localStorage) ===================== */
function addToCart(id, qty=1, toast=false){
  const cart = loadCart();
  cart[id] = (cart[id] || 0) + qty;
  if(cart[id] <= 0) delete cart[id];
  saveCart(cart);
  renderCart();
  if(toast) showToast('Ditambahkan ke keranjang');
}
function removeFromCart(id){
  const cart = loadCart();
  delete cart[id];
  saveCart(cart);
  renderCart();
}
function clearCart(){
  saveCart({});
  renderCart();
}
function cartTotals(){
  const cart = loadCart();
  let count = 0;
  let total = 0;
  for(const [idStr, qty] of Object.entries(cart)){
    const id = Number(idStr);
    const p = products.find(x=>x.id===id);
    if(!p) continue;
    count += Number(qty||0);
    total += Number(p.price||0) * Number(qty||0);
  }
  return {count, total};
}

const cartBody = document.getElementById('cartBody');
const cartTotalText = document.getElementById('cartTotalText');
const cartBadge = document.getElementById('cartBadge');

function renderCart(){
  const cart = loadCart();
  const {count, total} = cartTotals();

  if(count > 0){
    cartBadge.style.display = 'grid';
    cartBadge.textContent = String(count);
  } else {
    cartBadge.style.display = 'none';
  }

  cartTotalText.textContent = rupiah(total);

  const keys = Object.keys(cart);
  if(keys.length === 0){
    cartBody.innerHTML = `<div class="cartEmpty">Keranjang masih kosong. Yuk belanja dulu üòä</div>`;
    return;
  }

  let html = '';
  keys.forEach(idStr=>{
    const id = Number(idStr);
    const qty = Number(cart[idStr] || 0);
    const p = products.find(x=>x.id===id);
    if(!p) return;
    const lineTotal = p.price * qty;

    html += `
      <div class="cartItem">
        <img src="${escapeHtml(p.img)}" alt="${escapeHtml(p.name)}"/>
        <div>
          <div class="title">${escapeHtml(p.name)}</div>
          <div class="sub">${rupiah(p.price)} ¬∑ Subtotal: <b>${rupiah(lineTotal)}</b></div>
          <div class="qty" style="margin-top:10px">
            <button class="qbtn" data-qty="-1" data-id="${id}" title="Kurangi">‚àí</button>
            <div style="min-width:26px;text-align:center;font-weight:900">${qty}</div>
            <button class="qbtn" data-qty="1" data-id="${id}" title="Tambah">+</button>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:10px">
          <button class="remove" data-remove="${id}">Hapus</button>
        </div>
      </div>
    `;
  });

  cartBody.innerHTML = html;

  cartBody.querySelectorAll('button[data-qty]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = Number(b.dataset.id);
      const delta = Number(b.dataset.qty);
      addToCart(id, delta, false);
    });
  });
  cartBody.querySelectorAll('button[data-remove]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = Number(b.dataset.remove);
      removeFromCart(id);
    });
  });
}
renderCart();

document.getElementById('btnClearCart').addEventListener('click', (e)=>{
  e.preventDefault();
  clearCart();
  showToast('Keranjang dikosongkan');
});
document.getElementById('btnCheckout').addEventListener('click', function(e){
  e.preventDefault();

  const cart = localStorage.getItem('liv_cart');
  if(!cart || cart === '{}'){
    alert('Keranjang masih kosong');
    return;
  }

  // pindah ke payment
  window.location.href = 'payment.html';
});

/* ===================== PROFILE (DB USER ‚Üí localStorage) ===================== */
function syncProfileUI(){
  const p = loadProfile();
  const name = p.nama || 'Pelanggan';
  const email = p.email || 'pelanggan@email.com';
  const member = p.member || 'REGULER';

  document.getElementById('meName').textContent = name;
  document.getElementById('meEmail').textContent = email;
  document.getElementById('meMember').textContent = member;

  document.getElementById('editNama').value = name;
  document.getElementById('editEmail').value = email;

  const o = loadLastOrder();
  document.getElementById('lastOrder').textContent = o.id ? ('#' + o.id) : '-';
  document.getElementById('lastStatus').textContent = o.status ? (o.status.charAt(0).toUpperCase()+o.status.slice(1)) : '-';
  document.getElementById('lastEta').textContent = o.eta || '-';
}
syncProfileUI();

document.getElementById('btnSaveProfile').addEventListener('click', ()=>{
  const nama = document.getElementById('editNama').value.trim();
  const email = document.getElementById('editEmail').value.trim();
  const p = loadProfile();
  p.nama = nama || 'Pelanggan';
  p.email = email || 'pelanggan@email.com';
  if(!p.member) p.member = 'REGULER';
  saveProfile(p);
  syncProfileUI();
  showToast('Profil tersimpan');
});

/* ===================== SETTINGS TABS ===================== */
const tabs = document.getElementById('tabs');
const tabContent = document.getElementById('tabContent');
tabs.addEventListener('click', (e)=>{
  const t = e.target.closest('.tab');
  if(!t) return;
  tabs.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
  t.classList.add('active');
  const key = t.dataset.tab;
  if(key==='mode') tabContent.textContent = 'Mode tampilan: Light (default). (Simulasi UI)';
  if(key==='alamat') tabContent.textContent = 'Alamat pengiriman tersimpan: Jl. Contoh No. 123, Yogyakarta. (Simulasi)';
  if(key==='bayar') tabContent.textContent = 'Metode pembayaran: Transfer / E-Wallet / COD. (Simulasi)';
});

document.getElementById('btnLogoutSim').addEventListener('click', (e)=>{
  e.preventDefault();
  // Simulasi logout: reset cart + last order (mirip PHP action logout_sim)
  clearCart();
  saveLastOrder({});
  showToast('Logout (simulasi)');
});

/* ===================== CATEGORY + SEARCH FILTER (CLIENT) ===================== */
let activeCat = 'All';
let activeQuery = '';

const pills = document.getElementById('pills');
const q = document.getElementById('q');
const emptyState = document.getElementById('emptyState');

function applyFilters(){
  const cards = grid.querySelectorAll('.product');
  let shown = 0;
  cards.forEach(card=>{
    const cat = card.dataset.cat;
    const name = card.dataset.name || '';
    const okCat = (activeCat==='All' || cat===activeCat);
    const okQ = (!activeQuery || name.includes(activeQuery));
    card.style.display = (okCat && okQ) ? '' : 'none';
    if(okCat && okQ) shown++;
  });
  emptyState.style.display = (shown===0) ? 'block' : 'none';
}

pills.addEventListener('click', (e)=>{
  const btn = e.target.closest('.pill');
  if(!btn) return;
  activeCat = btn.dataset.cat;
  document.querySelectorAll('.pill').forEach(p=>p.classList.remove('active'));
  btn.classList.add('active');
  applyFilters();
});

q.addEventListener('input', ()=>{
  activeQuery = q.value.trim().toLowerCase();
  applyFilters();
});
document.getElementById('btnSearch').addEventListener('click', ()=>{
  activeQuery = q.value.trim().toLowerCase();
  applyFilters();
});

/* ===================== HERO SLIDER ===================== */
const slides = document.querySelectorAll('.heroSlide');
const dotsWrap = document.getElementById('heroDots');
let slideIdx = 0;

slides.forEach((_, i)=>{
  const d = document.createElement('div');
  d.className = 'dot' + (i===0 ? ' active' : '');
  d.addEventListener('click', ()=>{ slideIdx=i; renderSlides(); });
  dotsWrap.appendChild(d);
});

function renderSlides(){
  slides.forEach((s,i)=>{ s.style.display = (i===slideIdx) ? 'block' : 'none'; });
  dotsWrap.querySelectorAll('.dot').forEach((d,i)=>d.classList.toggle('active', i===slideIdx));
}
function nextSlide(){
  slideIdx = (slideIdx + 1) % slides.length;
  renderSlides();
}
renderSlides();
setInterval(nextSlide, 3500);

/* ===================== ULASAN ===================== */
function openReview(productId){
  const body = document.getElementById('reviewBody');
  body.innerHTML = '';

  if(!reviews[productId]){
    body.innerHTML = '<p class="note">Belum ada ulasan.</p>';
  } else {
    reviews[productId].forEach(r=>{
      body.innerHTML += `
        <div class="meCard">
          <b>${escapeHtml(r.user)}</b> ¬∑ ‚≠ê ${escapeHtml(r.rating)}
          <p>${escapeHtml(r.comment)}</p>
        </div>
      `;
    });
  }

  openDrawer('review');
}

/* initial */
applyFilters();

</script>

<script>
localStorage.setItem("liv_products", JSON.stringify(products));
</script>


</body>
</html>
